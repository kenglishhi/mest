<html>
  <head>
    <title>BiococonutIsland :: Workbench </title>
    <%= stylesheet_link_tag "/javascripts/ext-3.0.0/resources/css/ext-all.css",
      "ext-override",
      "workbench-style"
  %>

    <%= javascript_tag "var FORM_AUTH_TOKEN = '#{form_auth_token}';" %>

    <%= javascript_include_tag 'jquery-1.3.2.min.js',
      "ext-3.0.0/adapter/jquery/ext-jquery-adapter.js",
      "ext-3.0.0/adapter/ext/ext-base",
      "ext-3.0.0/ext-all" ,
      "workbench/base",
      "workbench/bio-notifier"
  %>
    <script type="text/javascript" >

      Ext.onReady(function(){
        function createNcbiBlastSearchForm() {
          var params = {};
          params.ALIGNMENT_VIEW = "Pairwise";
          params.ALIGNMENTS = "100";
          params.ALIGNMENT_VIEW
          params.BLAST_PROGRAMS = 'blastn';
          params.BLAST_SPEC = "";
          params.CLIENT = "web";
          params.CMD = "request" ;
          params.COMPOSITION_BASED_STATISTICS  = ''
          params.DATABASE = 'nr';
          params.db = 'nucleotide'
          params.DB_ABBR = "";
          params.DB_DIR_PREFIX="";
          params.DBTYPE = 'gc';
          params.DEFAULT_PROG = "megaBlast";
          params.DESCRIPTIONS = "100";
          params.EQ_MENU  = ''
          params.EQ_TEXT = ''
          params.EXCLUDE_MODELS  = 'on'
          params.EXCLUDE_SEQ_UNCULT = 'on'
          params.EXPECT = '10';
          params.EXPECT_HIGH="";
          params.EXPECT_LOW="";
          params.FILTER = ''
          params.FORMAT_EQ_TEXT="";
          params.FORMAT_OBJECT = "Alignment";
          params.FORMAT_ORGANISM="";
          params.FORMAT_TYPE = "HTML";
          params.GAPCOSTS = ''
          params.GENETIC_CODE = ''
          params.GET_SEQUENCE = true;
          params.I_THRESH = "";
          params.JOB_TITLE = 'MaybeHiVxxxxxxyyyy';
          params.LCASE_MASK  = 'on'
          params.MASK_CHAR = "2";
          params.MASK_COLOR ="1";
          params.MATCH_SCORES = '1,-2';
          params.MATRIX_NAME = ''
          params.MAX_NUM_SEQ  = '20'
          params.MEGABLAST = "on" ;
          params.NCBI_GI=false;
          params.NEW_VIEW =true;
          params.NEWWIN = 'on'
          params.NO_COMMON="";
          params.NUM_DIFFS="1";
          params.NUM_OPTS_DIFFS="0";
          params.NUM_ORG  = '1'
          params.NUM_OVERVIEW="100";
          params.OLD_BLAST=false;
          params.ORG_EXCLUDE  = ''
          params.PAGE = "MegaBlast" ;
          params.PAGE_TYPE="BlastSearch";
          params.PHI_PATTERN  = ''
          params.PROGRAM = "blastn" ;
          params.PSSM = ''
          params.QUERY = "GAAGAGATAGTAATTAGATCTGCCAATTTCACAGACAATGCTAAAATCATAATAGTACAGCTAAATGCATCTGTAGAAATTAATTGTACAAGACCCAACAACAATACAAGAAAAGGTATAAATATAGGACCAGGGAGGGCATTTTATGCAACAGGAGGAATAATAGGAGATATAAGACAAGCACATTGTAACATTAGTGAGGAAAAATGGAATAATACTTTAAAACAGGTAGTTACAAAATTAAGAGAACAATTTGGGAATAAAACAATAATCTTCAATCACTCCTCAGGAGGGGACCCAGAAATTGT";
          params.QUERY_BELIEVE_DEFLINE="";
          params.QUERY_FROM = ''
          params.QUERY_INDEX = "";
          params.QUERY_TO = ''
          params.QUERYFILE = ''
          params.REPEATS = ''
          params.RUN_PSIBLAST = "" ;
          params.SAVED_PSSM="";
          params.SAVED_SEARCH=true;
          params.SELECTED_PROG_TYPE="megaBlast";
          params.SERVICE = "plain";
          params.SHORT_QUERY_ADJUST  = ''
          params.SHOW_CDS_FEATURE=false;
          params.SHOW_LINKOUT= true;
          params.SHOW_OVERVIEW = true;
          params.stype = 'nucleotide';
          params.SUBJECTFILE = ''
          params.SUBJECTS = ''
          params.SUBJECTS_FROM = ''
          params.SUBJECTS_TO = ''
          params.TEMPLATE_LENGTH = ''
          params.TEMPLATE_TYPE = ''
          params.TWO_HITS = "" ;
          params.UNIQ_DEFAULTS_NAME="A_SearchDefaults_1N2ADa_oee_1Z5H3Q7o1_GTR6V_1OgPIQ";
          params.USER_DATABASE="";
          params.USER_DEFAULT_MATCH_SCORES="0";
          params.USER_DEFAULT_PROG_TYPE="megaBlast";
          params.USER_FORMAT_DEFAULTS="";
          params.USER_MATCH_SCORES="";
          params.USER_WORD_SIZE="";
          params.WORD_SIZE = '28';
          params.WWW_BLAST_TYPE = "";


          var url = 'http://blast.ncbi.nlm.nih.gov/Blast.cgi';
          var form = document.createElement("form");
          form.setAttribute("target", "_blank");
          form.setAttribute("method", "POST");
          form.setAttribute("action", url);
          form.setAttribute("enctype","multipart/form-data");
          form.setAttribute("class", "f-wrap-1 all");
          form.setAttribute("id","ncbi-blast-search-form");

          for(var key in params) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("id", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
          }
          document.body.appendChild(form);    // Not entirely sure if this is necessary
        }

        createNcbiBlastSearchForm();
        var blastButton = Ext.get('ncbi-blast');
        blastButton.on('click', function(){
          $("#ncbi-blast-search-form").submit();
        });
      });

    </script>

  </head>
  <body>
    This will test blasting a sequence against NCBI: <br /><br /><br />
    <input type="button" id="ncbi-blast" value="Do NCBI Blast" /><br />
  </body>
</html>
